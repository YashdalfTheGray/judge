<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ðŸ¦»ðŸ«–</title>

    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3EðŸ•’%3C/text%3E%3C/svg%3E"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: 'Noto Sans', sans-serif;
      }
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #121212;
          color: #f5f5f5;
        }

        button {
          background-color: #1e1e1e;
          color: #f5f5f5;
          border-color: #555;
        }

        output {
          color: #f5f5f5;
        }
      }

      @media (prefers-color-scheme: light) {
        body {
          background-color: #ffffff;
          color: #000000;
        }

        button {
          background-color: #f0f0f0;
          color: #000000;
          border-color: #aaa;
        }

        output {
          color: #000000;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <button id="listen-button" data-listening="false">We listen</button>
      <output id="timer" role="timer">00:00:00</output>
      <button id="judge-button">We don't judge</button>
    </main>

    <script type="module">
      document.addEventListener('DOMContentLoaded', () => {
        const listenBtn = document.querySelector('#listen-button');
        const judgeBtn = document.querySelector('#judge-button');
        const timerDisplay = document.querySelector('#timer');

        let seconds = 0;
        let intervalId = null;

        const formatTime = (seconds) => {
          const date = new Date(seconds * 1000);
          return new Intl.DateTimeFormat('en-US', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false,
            timeZone: 'UTC',
          }).format(date);
        };

        const startTimer = () => {
          if (listenBtn.dataset.listening === 'true') return;

          listenBtn.dataset.listening = 'true';
          intervalId = setInterval(() => {
            seconds += 1;
            timerDisplay.textContent = formatTime(seconds);
          }, 1000);

          if (Math.random() < 0.2) {
            judgeBtn.textContent = 'We judge';
          }
        };

        const resetTimer = () => {
          clearInterval(intervalId);
          intervalId = null;
          seconds = 0;
          timerDisplay.textContent = '00:00:00';
          judgeBtn.textContent = "We don't judge";
          listenBtn.dataset.listening = 'false';
        };

        listenBtn.addEventListener('click', startTimer);
        judgeBtn.addEventListener('click', resetTimer);
      });
    </script>
  </body>
</html>
